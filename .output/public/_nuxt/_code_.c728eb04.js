import{u as $,C as I,E as T,_ as L}from"./Enroll.027f8d65.js";import G from"./Input.c13c5c5f.js";import O from"./FormGroup.a21e2881.js";import z from"./Button.ca57eb16.js";import A from"./Form.336d0390.js";import{f as H,bD as J,bE as K,i as V,j as p,r as Q,n as W,o as v,c as y,a as m,g as e,F as R,b as t,w as n,d as i,t as b,h as X}from"./entry.2e60e461.js";import{c as Y,a as x,b as Z}from"./index.esm.caf07660.js";import{s as h,g as c}from"./index.ccfc92be.js";import"./fetch.accb1318.js";import"./Link.fb4a2cb7.js";import"./nuxt-link.37c5b906.js";import"./Icon.4abee38d.js";import"./Icon.d59a0deb.js";import"./index.b8fe2cb5.js";import"./tw-merge.608f89b9.js";import"./selectMenu.219fca56.js";import"./useFormGroup.a790b1a9.js";import"./uid.12f507af.js";import"./useButtonGroup.cc33183f.js";import"./button.b8dbcbb7.js";import"./index.b36c4f78.js";import"./_commonjsHelpers.23102255.js";const ee={class:"flex h-full justify-center items-center"},te={class:"flex flex-col items-center gap-10"},se={class:"flex w-full gap-4"},oe={class:"flex justify-end w-full"},ae={class:"text-center"},ne={class:"text-warning-400"},re=m("br",null,null,-1),le={class:"w-full flex justify-between"},Ee=H({__name:"[code]",setup(ie){const D=J(),E=K(),k=V(()=>D.params.code),S=$(),{classFromCode:j,enroll:M}=S,g=p(),a=Q({firstname:"",lastname:"",password:"",confirmpassword:"",classID:""}),f=p(),U=V(()=>{var s;return(s=c(f))==null?void 0:s.class}),C=p(!1);W(async()=>{var s;h(f,await j(c(k))),h(C,!0),a.classID=`${(s=c(U))==null?void 0:s.id}`});const q=p([]),F=V(()=>{const{firstname:s,lastname:o}=a;return c(q).some(([d,l])=>d===s&&l===o)}),N=Y({firstname:x().required("Firstname Required").max(32,"Max character limit").test("checkDupName","User already exists",()=>new Promise((s,o)=>s(!c(F)))),lastname:x().required("Lastname Required").max(32,"Max character limit").test("checkDupName","User already exists",()=>new Promise((s,o)=>s(!c(F)))),password:x().min(4,"Must be at least 4 characters").required("Password Required").max(32,"Max character limit"),confirmpassword:x().oneOf([Z("password"),""],"Passwords must match").required("This field is required")}),_=p(!1),P=async s=>{h(_,!0);const{data:{firstname:o,lastname:d}}=s,l=await M(a);if(h(_,!1),!l)return;const{status:u}=l;if(u===T.Successful)E.push("/login");else{if(c(q).push([o,d]),!g.value)return;g.value.validate()}};return(s,o)=>{const d=L,l=G,u=O,w=z,B=A;return v(),y("div",ee,[m("div",te,[e(f)&&e(f).status===e(I).Valid?(v(),y(R,{key:0},[t(d,{class:"text-center"},{default:n(()=>{var r;return[i("Enroll to "+b((r=e(U))==null?void 0:r.name),1)]}),_:1}),t(B,{schema:e(N),state:e(a),onSubmit:P,class:"flex flex-col items-center gap-1 w-[90%]",ref_key:"form",ref:g},{default:n(()=>[m("div",se,[t(u,{class:"w-full",name:"firstname",help:"‏"},{default:n(()=>[t(l,{placeholder:"Firstname",modelValue:e(a).firstname,"onUpdate:modelValue":o[0]||(o[0]=r=>e(a).firstname=r)},null,8,["modelValue"])]),_:1}),t(u,{class:"w-full",name:"lastname"},{default:n(()=>[t(l,{placeholder:"Lastname",modelValue:e(a).lastname,"onUpdate:modelValue":o[1]||(o[1]=r=>e(a).lastname=r)},null,8,["modelValue"])]),_:1})]),t(u,{class:"w-full",name:"password",help:"‏"},{default:n(()=>[t(l,{placeholder:"Password",type:"password",modelValue:e(a).password,"onUpdate:modelValue":o[2]||(o[2]=r=>e(a).password=r)},null,8,["modelValue"])]),_:1}),t(u,{class:"w-full",name:"confirmpassword",help:"‏"},{default:n(()=>[t(l,{placeholder:"Confirm Password",type:"password",modelValue:e(a).confirmpassword,"onUpdate:modelValue":o[3]||(o[3]=r=>e(a).confirmpassword=r)},null,8,["modelValue"])]),_:1}),m("div",oe,[t(w,{variant:"link",padded:!1,color:"white",to:{path:"/login"}},{default:n(()=>[i("or login with an existing account")]),_:1})]),t(w,{type:"submit",color:"white",block:"",class:"max-w-[150px] mt-10",loading:e(_)},{default:n(()=>[i(b(e(_)?"enrolling":"enroll"),1)]),_:1},8,["loading"])]),_:1},8,["schema","state"])],64)):e(C)?(v(),y(R,{key:1},[t(d,null,{default:n(()=>[i("Invalid Code")]),_:1}),m("div",ae,[i(" The code "),m("span",ne,b(e(k)),1),i(" you are given is not a valid code "),re,i(" Did you paste the correct link? ")]),m("div",le,[t(w,{variant:"link",color:"amber",to:"/enroll"},{default:n(()=>[i("Re-enter code")]),_:1}),t(w,{variant:"link",color:"green",to:"/login"},{default:n(()=>[i("or Login")]),_:1})])],64)):X("",!0)])])}}});export{Ee as default};
